<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">

<dom-module id="chernoff-faces">

<style is="custom-style">
  @import url("../../styles/app-theme.html");
</style>
<link rel="import" type="css" href="chernoff-faces.css">

  <template>

    <!-- Shadow DOM -->
    <paper-material elevation="1">
        <div class="top-bar">
            <iron-icon icon="{{icon}}"></iron-icon>
            <span>{{title}}</span>
        </div>
        <canvas id="chernoff"></canvas>
        <span id="brand">{{brand}}</span>
        <div style="width:100%; clear: both"></div>
        <div style="float:left">  
            <paper-icon-button icon="info" data-dialog="animated" alt="info" id="button" on-tap="showDialog"></paper-icon-button>
            <paper-dialog id="animated" entry-animation="scale-up-animation" exit-animation="fade-out-animation" with-backdrop>
              <h2>Chernoff Faces</h2>
              </br>
              <p>Chernoff faces, invented by Herman Chernoff, display multivariate data in the shape of a human face. The individual parts, such as eyes, ears, mouth and nose represent values of the variables by their shape, size, placement and orientation. The idea behind using faces is that humans easily recognize faces and notice small changes without difficulty. Chernoff faces handle each variable differently. Because the features of the faces vary in perceived importance, the way in which variables are mapped to the features should be carefully chosen (e.g. eye size and eyebrow-slant have been found to carry significant weight).</p>
            </paper-dialog>
        </div>
        <div style="width:100%; clear: both"></div>
    </paper-material>

  </template>

  <script>

    function drawChernoffFace(el, widthP, hlE, pE, aE, cM) {
      console.log(widthP, hlE, pE, aE, cM)
      var width = widthP;
      var height = widthP;
      half_length_of_eyes_ratio = hlE;
      position_of_eyes_ratio = pE;
      angle_of_eyebrow_ratio = aE;
      curvature_of_mouth_ratio = cM;
      var c2 = el;
      c2.width = width;
      c2.height = height;
      $(el).chernoff({
        canvas: c2,
        half_length_of_eyes_ratio: half_length_of_eyes_ratio,
        position_of_eyes_ratio: position_of_eyes_ratio,
        angle_of_eyebrow_ratio: angle_of_eyebrow_ratio,
        curvature_of_mouth_ratio: curvature_of_mouth_ratio
      });
    }

    Polymer({

      is: 'chernoff-faces',

      properties: {

        data: {
            type: Array,
            value: [11, 35, 72, 9, 10] //default value for data array.
        },

        icon: {
          type: String,
          value: "face"
        },

        title: {
          type: String,
          value: "Chernoff Faces Chart"
        },

        brand: {
          type: String,
          value: "Undefined"
        },

        width: {
          type: Number,
          value: 200
        },

        height: {
          type: Number,
          value: 200
        }, 

        /* Half Length of Eyes Ratio */
        hlE: {
          type: String,
          value: "0.9",
          notify: true
        },

        /* Position of Eyes Ratio */
        pE: {
          type: String,
          value: "0.9"
        },

        /* Angle of Eyebrow Ratio */
        aE: {
          type: String,
          value: "0.9"
        },

        /* Curvature of Mouth Ratio */
        cM: {
          type: String,
          value: "0.9"
        }
      },

      ready: function() {   
          drawChernoffFace(this.$.chernoff, this.width, this.hlE, this.pE, this.aE, this.cM)
      },
      showDialog: function(e) {
        var button = this.$.button;
          while (!button.hasAttribute('data-dialog') && button !== document.body) {
            button = button.parentElement;
          }
          if (!button.hasAttribute('data-dialog')) {
            return;
          }
          var id = button.getAttribute('data-dialog');
          var dialog = document.getElementById(id);
          if (dialog) {
            dialog.open();
          }
      }

    });
  </script>

</dom-module>
